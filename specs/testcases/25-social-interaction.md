# 社交互动与反馈

> **格式约定：** 每条用例仅描述「场景」与「预期结果」，不包含测试方法和执行过程。
>
> **关联 User Journey：** `docs/user-journeys/06-social-interaction.md`

---

## 25.1 点赞

**TC-SOCIAL-001：点赞帖子**
用户对喜欢的帖子点赞，系统创建 interaction（type: like），帖子 like_count 递增。

**TC-SOCIAL-002：取消点赞**
用户取消之前的点赞，系统删除 interaction，帖子 like_count 递减。

**TC-SOCIAL-003：查看点赞数**
用户查看帖子详情，系统返回 like_count 缓存字段值。

**TC-SOCIAL-004：重复点赞被拒绝**
用户对同一帖子重复点赞，系统拒绝并返回冲突错误（409）。

**TC-SOCIAL-005：点赞已删除帖子被拒绝**
用户尝试点赞已软删除的帖子，系统返回 404。

**TC-SOCIAL-006：查看点赞列表**
用户查看自己点赞的所有帖子，系统返回按时间倒序的帖子列表。

**TC-SOCIAL-007：点赞列表分页**
用户点赞超过默认分页数量的帖子时，系统支持分页查询（skip/limit 参数）。

---

## 25.2 评论

**TC-SOCIAL-010：发表评论**
用户对帖子发表评论，系统创建 interaction（type: comment），帖子 comment_count 递增。

**TC-SOCIAL-011：回复评论**
用户回复他人的评论，系统创建 interaction（type: comment, parent_id 指向被回复评论）。

**TC-SOCIAL-012：删除评论**
用户删除自己发表的评论，系统执行软删除，帖子 comment_count 递减。

**TC-SOCIAL-013：查看评论列表**
用户查看帖子下的所有评论，系统返回按时间排序的评论列表（树形结构）。

**TC-SOCIAL-014：删除评论级联删除子评论**
用户删除有子评论的评论，系统同时软删除所有子评论，comment_count 相应递减。

---

## 25.3 评分

**TC-SOCIAL-020：评委打分**
被指定为活动评委的用户对参赛帖子进行打分，系统创建 interaction（type: rating），帖子 average_rating 更新。

**TC-SOCIAL-021：查看评分详情**
用户查看作品的评分详情，系统返回加权总分和各维度具体分数及评语。

**TC-SOCIAL-022：修改评分**
评委修改之前的评分，系统更新 interaction，帖子 average_rating 重新计算。

**TC-SOCIAL-023：非评委打分被拒绝**
未被指定为评委的用户尝试打分，系统拒绝并返回权限错误（403）。

**TC-SOCIAL-024：重复打分被拒绝**
评委对同一帖子重复创建评分（而非修改），系统拒绝并返回冲突错误（409）。

**TC-SOCIAL-025：查看平均分**
用户查看帖子详情，系统返回 average_rating 缓存字段值。

---

## 25.4 内容关注

**TC-SOCIAL-040：关注提案**
用户订阅特定提案的更新动态，系统记录关注关系。

**TC-SOCIAL-041：关注团队**
用户订阅特定团队的动态，系统记录关注关系。

**TC-SOCIAL-042：取消内容关注**
用户取消对提案或团队的关注，系统删除关注记录。

**TC-SOCIAL-043：关注活动**
用户订阅特定活动的更新动态，系统记录关注关系。

**TC-SOCIAL-044：查看关注列表**
用户查看自己关注的内容列表，系统返回分类展示（活动/提案/团队）。

---

## 25.5 分享

**TC-SOCIAL-050：分享活动**
用户将活动分享到外部社交媒体，系统生成分享链接或卡片。

**TC-SOCIAL-051：分享帖子**
用户将帖子分享到外部社交媒体，系统生成分享链接或卡片。

**TC-SOCIAL-052：分享通知**
用户将收到的通知内容分享，系统生成分享内容。

**TC-SOCIAL-053：复制分享链接**
用户点击复制链接，系统将内容链接复制到剪贴板。

---

## 25.6 缓存一致性

**TC-SOCIAL-060：like_count 一致性**
在高并发点赞/取消点赞场景下，like_count 最终与实际点赞数一致。

**TC-SOCIAL-061：comment_count 一致性**
在高并发评论/删除场景下，comment_count 最终与实际评论数一致。

**TC-SOCIAL-062：average_rating 一致性**
在多评委打分/修改场景下，average_rating 最终与实际平均分一致。

---

## 25.7 负向/边界

**TC-SOCIAL-900：未登录用户点赞被拒绝**
未登录用户尝试点赞，系统返回 401 需要认证。

**TC-SOCIAL-901：未登录用户评论被拒绝**
未登录用户尝试发表评论，系统返回 401 需要认证。

**TC-SOCIAL-902：对不可见内容互动被拒绝**
用户尝试对 private 帖子（非本人）进行点赞/评论，系统返回 404。

**TC-SOCIAL-903：非本人删除评论被拒绝**
用户尝试删除他人发表的评论，系统拒绝并返回权限错误。

**TC-SOCIAL-904：空内容评论被拒绝**
用户尝试发表空内容的评论，系统返回验证错误（422）。

**TC-SOCIAL-905：评分权重不符规则被拒绝**
评委打分时各维度不在 0-100 范围内，系统拒绝保存。

**TC-SOCIAL-906：关注自己被拒绝**
用户尝试关注自己创建的内容，系统拒绝或忽略。
