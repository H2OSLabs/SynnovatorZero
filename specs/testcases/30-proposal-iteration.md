# 提案迭代与版本日志

> **格式约定：** 每条用例仅描述「场景」与「预期结果」，不包含测试方法和执行过程。
>
> 本文件聚焦于**提案的迭代日志自动生成**和**版本差异对比**功能，与 24-content-creation.md 中的基础版本管理（TC-CREATE-051/052）互补。

---

## 30.1 提案资产更新

**TC-PROPOSAL-001：编辑提案内资产并保存**
用户在提案中编辑关联资产的内容，点击保存，系统更新 resource 记录，提案状态变为"已更新未发布"。

**TC-PROPOSAL-002：多次更新后统一发布**
用户多次编辑提案内的资产并保存，累积多个更新后点击发布，系统将所有更新打包为一个新版本。

**TC-PROPOSAL-003：保存资产同步更新关联资产**
用户在提案中编辑资产后保存，该资产在其他关联位置（如个人资产库）同步更新内容。

## 30.2 提案版本发布

**TC-PROPOSAL-010：提案发布产生新版本号**
用户点击发布提案，系统自动递增版本号（如 v1 → v2），记录发布时间。

**TC-PROPOSAL-011：系统自动生成迭代日志**
提案发布后，系统对比上一版本和当前版本，自动检测变更内容（新增/修改/删除的资产），生成迭代日志。

**TC-PROPOSAL-012：迭代日志不可被用户更改**
系统自动生成的迭代日志为只读，用户无法编辑或删除迭代日志内容。

**TC-PROPOSAL-013：迭代日志展示在提案页面**
访问提案详情页时，迭代日志按版本倒序展示，用户可查看每个版本的变更内容。

## 30.3 版本比较

**TC-PROPOSAL-020：查看任意两个版本的差异**
用户选择提案的两个历史版本进行对比，系统高亮显示差异内容。

**TC-PROPOSAL-021：查看单个版本的完整快照**
用户点击某个历史版本，系统展示该版本发布时的完整提案内容（包括所有关联资产）。

## 30.4 负向/边界

**TC-PROPOSAL-900：未保存直接关闭编辑器**
用户编辑提案资产后未保存直接关闭编辑器，系统提示确认丢弃更改或保存草稿。

**TC-PROPOSAL-901：空更新发布被提示**
用户在未做任何修改的情况下尝试发布提案，系统提示"无变更内容"。

**TC-PROPOSAL-902：已删除提案无法查看版本历史**
尝试访问已软删除提案的版本历史，系统返回 404 或权限错误。
