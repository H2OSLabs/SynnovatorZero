# Component: Follow Button
name: follow-button
category: action
description: 关注按钮，支持关注/取消关注用户

props:
  target_user_id:
    type: number
    required: true
  initial_following:
    type: boolean
    default: false

states:
  default:
    label: 关注
    variant: outline
    icon: plus
  following:
    label: 已关注
    variant: filled
    icon: check
  loading:
    label: 处理中
    disabled: true

interactions:
  - trigger: click
    condition: "!is_loading && target_user_id != current_user.id"
    action: toggle_follow
    api_call:
      following_true:
        method: DELETE
        endpoint: "/api/users/{target_user_id}/follow"
        headers:
          X-User-Id: "{current_user.id}"
      following_false:
        method: POST
        endpoint: "/api/users/{target_user_id}/follow"
        headers:
          X-User-Id: "{current_user.id}"
    optimistic_update:
      - field: following
        operation: toggle
    error_rollback: true
    on_unauthenticated:
      action: show_modal
      target: login-prompt

  - trigger: hover
    condition: following
    action: change_label
    content: "取消关注"

accessibility:
  role: button
  aria-label: "{following ? '取消关注' : '关注'} {target_user.display_name}"
  aria-pressed: "{following}"
